---
author: admin
comments: true
date: 2010-09-15 11:31:20+00:00
layout: post
slug: ballsproof
title: 《魔术球》问题公式解法证明
wordpress_id: 10
categories:
- 解题报告
tags:
- 公式
- 网络流
- 解题报告
- 证明
- 魔术球问题
---



问题描述：
假设有n根柱子，现要按下述规则在这n根柱子中依次放入编号为 1，2，3，4......的球。
（1）每次只能在某根柱子的最上面放球。
（2）在同一根柱子中，任何2个相邻球的编号之和为完全平方数。
试设计一个算法，计算出在n根柱子上最多能放多少个球。例如，在4 根柱子上最多可
放11个球。
´编程任务：
对于给定的n，计算在 n根柱子上最多能放多少个球。

´数据输入：
文件第1 行有 1个正整数n，表示柱子数。
´结果输出:
文件的第一行是球数。

数据规模

n<=60  保证答案小于1600

输入文件示例

4

输出文件示例

11

方案如下

1 8
2 7 9
3 6 10
4 5 11

每一行表示一个柱子上的球

========分割线=========




﻿这道题有经典的网络流最小路径覆盖建模，这里不再啰嗦。

黑书上提到了公式法，答案即为ans=[n^2/2+n-1/2]，但是却没给出明确的证明。

这里先证明一下上界。
证明：

假设存在一组放置方法优于ans，那么必然存在一个方案可以放置球数为ans+1。

则ans+1个数中最大的两个为[n^2/2+n-1/2]和[n^2/2+n+1/2]

[n^2/2+n-1/2]+[n^2/2+n+1/2] <= n^2 +2n < (n+1)^2

最大n+1中最小的2个数为[n^2/2+1/2]和[n^2/2+3/2]

满足[n^2/2+1/2]+[n^2+3/2] >= n^2+1 > (n-1)^2

最大n+1个球中最小两球和最大两球都夹在两个完全平方数之间，那么n+1个球中任取两个都无法凑成一个完全平方数，而只有n个柱子，故不可能放置，上界得以证明。

下界黑书上说用贪心法可以得到，实践的具体贪心法是只要不用放新柱子就放在旧柱子上，我还不会证明，欢迎大家交流。
